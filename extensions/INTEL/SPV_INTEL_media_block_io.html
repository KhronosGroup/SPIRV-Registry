<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>SPV_INTEL_media_block_io</title>
<style>
@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";
@import "https://cdn.jsdelivr.net/gh/asciidoctor/asciidoctor@2.0/data/stylesheets/asciidoctor-default.css";

p {
    font-family: Arial, Helvetica, sans-serif;
    line-height: normal;
}
em, b, strong {
    color: darkblue;
}

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>SPV_INTEL_media_block_io</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_name_strings">Name Strings</a></li>
<li><a href="#_contact">Contact</a></li>
<li><a href="#_contributors">Contributors</a></li>
<li><a href="#_notice">Notice</a></li>
<li><a href="#_status">Status</a></li>
<li><a href="#_version">Version</a></li>
<li><a href="#_dependencies">Dependencies</a></li>
<li><a href="#_overview">Overview</a></li>
<li><a href="#_extension_name">Extension Name</a></li>
<li><a href="#_new_capabilities">New Capabilities</a></li>
<li><a href="#_new_instructions">New Instructions</a></li>
<li><a href="#_token_number_assignments">Token Number Assignments</a></li>
<li><a href="#_modifications_to_the_spir_v_specification_version_1_2">Modifications to the SPIR-V Specification, Version 1.2</a></li>
<li><a href="#_validation_rules">Validation Rules</a></li>
<li><a href="#_issues">Issues</a></li>
<li><a href="#_revision_history">Revision History</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name_strings">Name Strings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SPV_INTEL_media_block_io</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contact">Contact</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To report problems with this extension, please open a new issue at:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/KhronosGroup/SPIRV-Registry" class="bare">https://github.com/KhronosGroup/SPIRV-Registry</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributors">Contributors</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Ben Ashbaugh, Intel<br></p>
</li>
<li>
<p>Biju George, Intel</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notice">Notice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copyright (c) 2018 Intel Corporation.  All rights reserved.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_status">Status</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Final Draft</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_version">Version</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stripes-even" style="width: 40%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last Modified Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2018-10-29</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Revision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_dependencies">Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension is written against the SPIR-V Specification,
Version 1.2 Revision 1.</p>
</div>
<div class="paragraph">
<p>This extension requires SPIR-V 1.0.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds additional subgroup block read and write functionality that allow applications to flexibly specify the width and height of the block to read from or write to a 2D image.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extension_name">Extension Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use this extension within a SPIR-V module, the appropriate <strong>OpExtension</strong> must be present in the module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>OpExtension "SPV_INTEL_media_block_io"</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_new_capabilities">New Capabilities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension introduces new capabilities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SubgroupImageMediaBlockIOINTEL</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_new_instructions">New Instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Instructions added under the <strong>SubgroupImageMediaBlockIOINTEL</strong> capability:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>OpSubgroupImageMediaBlockReadINTEL
OpSubgroupImageMediaBlockWriteINTEL</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_token_number_assignments">Token Number Assignments</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-rows stripes-even" style="width: 40%;">
<colgroup>
<col style="width: 70%;">
<col style="width: 30%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SubgroupImageMediaBlockIOINTEL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5579</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpSubgroupImageMediaBlockReadINTEL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5580</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpSubgroupImageMediaBlockWriteINTEL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5581</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_modifications_to_the_spir_v_specification_version_1_2">Modifications to the SPIR-V Specification, Version 1.2</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_capabilities">Capabilities</h3>
<div class="paragraph">
<p>Modify Section 3.31, Capability, adding rows to the Capability table:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 5.2631%;">
<col style="width: 52.6315%;">
<col style="width: 21.0526%;">
<col style="width: 21.0528%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">Capability</th>
<th class="tableblock halign-center valign-top">Implicitly Declares</th>
<th class="tableblock halign-center valign-top">Enabled by Extension</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5579</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupImageMediaBlockIOINTEL</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SPV_INTEL_media_block_io</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_instructions">Instructions</h3>
<div class="paragraph">
<p>Modify Section 3.32.21, Group Instructions, adding to the end of the list of instructions:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="7"><p class="tableblock"><a id="OpSubgroupImageMediaBlockReadINTEL"></a><strong>OpSubgroupImageMediaBlockReadINTEL</strong><br>
<br>
Reads a block of data from a 2D region of the specified <em>Image</em>.</p>
<p class="tableblock"><em>Image</em> must be an object whose type is <strong>OpTypeImage</strong> with a <em>Sampled</em> operand of 0 or 2.</p>
<p class="tableblock">The <em>Result Type</em> is used to compute the maximum size of the 2D region that may be read, and may be a scalar or a vector type.  For this description, the block read <em>Component Type</em> is defined as the <em>Result Type</em> if <em>Result Type</em> is a scalar type, or as the vector <em>Component Type</em> if <em>Result Type</em> is a vector type.</p>
<p class="tableblock">The size of the 2D region to read is specified by the <em>Width</em> and <em>Height</em> operands.  The <em>Width</em> of the 2D region is expressed in units of the block read <em>Component Type</em>, and the <em>Height</em> directly describes the number of rows of the 2D region to read.</p>
<p class="tableblock">The <em>Coordinate</em> describes where in the <em>Image</em> to start reading the 2D region, and must be a vector of integer type.  The first component of the <em>Coordinate</em> is a byte coordinate into a row of the <em>Image</em> and is not expressed in units of the block read <em>Component Type</em>.  Remaining coordinates are non-normalized texel coordinates.</p>
<p class="tableblock">The data read from the 2D region is assigned to <em>Result</em> for each invocation in the subgroup by reorganizing the data read from the 2D region into a different 2D destination region in row major order.  The width of the destination 2D region is equivalent to <strong>SubgroupMaxSize</strong> in units of the <em>Component Type</em>, and the height of the destination 2D region is equivalent to one if <em>Result Type</em> is a scalar type, or to the vector <em>Component Count</em> if <em>Result Type</em> is a vector type.  The reorganization assigns rows of the source 2D region to the destination 2D region in row-major order.  If the source 2D region row byte width is not a power-of-two then the source 2D region row is assigned to the destination 2D region with undefined padding values to make a power-of-two row byte width.  Each invocation in the subgroup is then assigned a <em>Component Type</em> column vector of the reorganized 2D region, i.e. each invocation_s subsequent data element_s index is strided by the <strong>SubgroupMaxSize</strong> in the 2D destination region.</p>
<p class="tableblock">If the size of the requested 2D region to read is smaller than the 2D destination region then some tail components of some <em>Result</em> values will not be assigned values.  If the size of the 2D region to read is larger than the 2D destination region then some parts of the 2D region to read will be not be assigned and will be dropped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capability:<br>
<strong>SubgroupImageMediaBlockIOINTEL</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5580</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Result Type</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Result</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Image</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Coordinate</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Width</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Height</em></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 5.8823%;">
<col style="width: 5.8823%;">
<col style="width: 17.647%;">
<col style="width: 17.647%;">
<col style="width: 17.647%;">
<col style="width: 17.647%;">
<col style="width: 17.6474%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="6"><p class="tableblock"><a id="OpSubgroupImageMediaBlockWriteINTEL"></a><strong>OpSubgroupImageMediaBlockWriteINTEL</strong><br>
<br>
Writes a block of data into a 2D region of the specified <em>Image</em>.</p>
<p class="tableblock"><em>Image</em> must be an object whose type is <strong>OpTypeImage</strong> with a <em>Sampled</em> operand of 0 or 2.</p>
<p class="tableblock">The type of <em>Data</em> is used to compute the maximum size of the 2D region that may be written, and may be a scalar or a vector type.  For this description, the block write <em>Component Type</em> is defined as the type of <em>Data</em> if it is a scalar type, or the vector <em>Component Type</em> if it is a vector type.</p>
<p class="tableblock">The size of the 2D region to write is specified by the <em>Width</em> and <em>Height</em> operands.  The <em>Width</em> of the 2D region is expressed in units of the block write <em>Component Type</em>, and the <em>Height</em> directly describes the number of rows of the 2D region to write.</p>
<p class="tableblock">The <em>Coordinate</em> describes where in the <em>Image</em> to start writing the 2D region, and must be a vector of integer type.  The first component of the <em>Coordinate</em> is a byte coordinate into a row of the <em>Image</em> and is not expressed in units of the <em>Component Type</em>.  Remaining coordinates are non-normalized texel coordinates.</p>
<p class="tableblock">The <em>Data</em> for each invocation in the subgroup collectively forms a 2D source region, where the width of the 2D source region is equivalent to the <strong>SubgroupMaxSize</strong> in units of the block write <em>Component Type</em>, and the height of the 2D source region is equivalent to one if the type of <em>Data</em> is a scalar type, or to the vector <em>Component Count</em> if it is a vector type.  This 2D source region is then reorganized into a different 2D region to write.  The reorganization assigns data from the 2D source region to rows of the 2D region to write in row-major order.  If the row byte width of the 2D region to write is not a power-of-two, then some values from the 2D source region are skipped during assignment, so that each row of the 2D region to write begins at an byte offset that is a power-of-two.</p>
<p class="tableblock">If the size of the 2D source region is greater than the size of the 2D region to write then some tail components of some <em>Data</em> values will not be written.  This SPIR-V extension does not require any specific behavior when the size of the 2D source region is smaller than the size of the 2D region to write, but some environments may define behavior for this case.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capability:<br>
<strong>SubgroupImageMediaBlockIOINTEL</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5581</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Image</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Coordinate</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Width</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Height</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Data</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validation_rules">Validation Rules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>None.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_issues">Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>None.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_revision_history">Revision History</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-rows stripes-even stretch">
<colgroup>
<col style="width: 4.7619%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Rev</th>
<th class="tableblock halign-left valign-top">Date</th>
<th class="tableblock halign-left valign-top">Author</th>
<th class="tableblock halign-left valign-top">Changes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2018-10-29</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ben Ashbaugh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Initial revision</strong></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
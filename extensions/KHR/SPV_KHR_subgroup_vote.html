<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="AsciiDoc 8.6.9">
<title>SPV_KHR_subgroup_vote</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(1);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>SPV_KHR_subgroup_vote</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name_strings">Name Strings</h2>
<div class="sectionbody">
<div class="paragraph"><p>SPV_KHR_subgroup_vote</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_contact">Contact</h2>
<div class="sectionbody">
<div class="paragraph"><p>To report problems with this extension, please open a new issue at:</p></div>
<div class="paragraph"><p><a href="https://github.com/KhronosGroup/SPIRV-Headers">https://github.com/KhronosGroup/SPIRV-Headers</a></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_contributors">Contributors</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Kerch Holt, NVIDIA
</p>
</li>
<li>
<p>
Daniel Koch, NVIDIA
</p>
</li>
<li>
<p>
Ashwin Kolhe, NVIDIA
</p>
</li>
<li>
<p>
John Kessenich, Google
</p>
</li>
<li>
<p>
David Neto, Google
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_notice">Notice</h2>
<div class="sectionbody">
<div class="paragraph"><p>Copyright (c) 2016 The Khronos Group Inc. Copyright terms at
<a href="http://www.khronos.org/registry/speccopyright.html">http://www.khronos.org/registry/speccopyright.html</a></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_status">Status</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Complete
</p>
</li>
<li>
<p>
Approved by the SPIR Working Group: 2016-10-18
</p>
</li>
<li>
<p>
Ratified by the Khronos Board: 2017-01-11
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_version">Version</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all"
style="
width:40%;
">
<col style="width:50%;">
<col style="width:50%;">
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Last Modified Date</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2016-10-05</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Revision</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_dependencies">Dependencies</h2>
<div class="sectionbody">
<div class="paragraph"><p>This extension is written against the SPIR-V Specification,
Version 1.1 Revision 1.</p></div>
<div class="paragraph"><p>This extension requires SPIR-V 1.0.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph"><p>This extension adds three new subgroup instructions: <strong>OpSubgroupAllKHR</strong>,
<strong>OpSubgroupAnyKHR</strong>, and <strong>OpSubgroupAllEqualKHR</strong>
to support the OpenGL GL_ARB_shader_group_vote extension in
SPIR-V.</p></div>
<div class="paragraph"><p>Each of these instructions computes a boolean function over boolean values
contributed by the set of invocations in a subgroup.</p></div>
<div class="paragraph"><p>The new functionality is enabled under the <strong>SubgroupVoteKHR</strong> capability.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_extension_name">Extension Name</h2>
<div class="sectionbody">
<div class="paragraph"><p>To use this extension within a SPIR-V module, the following
<strong>OpExtension</strong> must be present in the module:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>OpExtension "SPV_KHR_subgroup_vote"</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_new_capabilities">New Capabilities</h2>
<div class="sectionbody">
<div class="paragraph"><p>This extension introduces a new capability:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>SubgroupVoteKHR</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_new_builtins">New Builtins</h2>
<div class="sectionbody">
<div class="paragraph"><p>None.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_new_instructions">New Instructions</h2>
<div class="sectionbody">
<div class="paragraph"><p>Instructions added under <strong>SubgroupVoteKHR</strong> capability:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>OpSubgroupAllKHR
OpSubgroupAnyKHR
OpSubgroupAllEqualKHR</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_token_number_assignments">Token Number Assignments</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-rows"
style="
width:40%;
">
<col style="width:70%;">
<col style="width:30%;">
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">OpSubgroupAllKHR</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4428</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">OpSubgroupAnyKHR</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4429</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">OpSubgroupAllEqualKHR</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4430</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">SubgroupVoteKHR</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4431</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_modifications_to_the_spir_v_specification_version_1_1">Modifications to the SPIR-V Specification, Version 1.1</h2>
<div class="sectionbody">
<div class="dlist"><dl>
<dt class="hdlist1">
(Add a new Section 2.21, Subgroup Vote) 
</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph"><p><a id="SubgroupVote"></a><strong>Subgroup Vote</strong></p></div>
<div class="paragraph"><p>This functionality is available on the <strong>OpSubgroupAllKHR</strong>,
<strong>OpSubgroupAnyKHR</strong>, and <strong>OpSubgroupAllEqualKHR</strong> instructions.
The <strong>SubgroupVoteKHR</strong> capability must be declared in any module
where these instructions are used.</p></div>
<div class="paragraph"><p>These operations may be executed within dynamically non-uniform control
flow.
In groups where some invocations do not execute the instruction, the
value returned is not affected by any invocation not executing the
instruction, even when <em>Predicate</em> is well-defined for that invocation.</p></div>
<div class="paragraph"><p>Since these instructions depend on the values of <em>Predicate</em> in an
implementation-defined group of invocations (the <strong>Subgroup</strong>), the value
returned by these instructions is implementation-defined.
However, <strong>OpSubgroupAnyKHR</strong> is guaranteed to return <strong>true</strong> if
<em>Predicate</em> evaluates to <strong>true</strong>, and <strong>OpSubgroupAllKHR</strong> is guaranteed
to return <strong>false</strong> if <em>Predicate</em> evaluates <strong>false</strong>.</p></div>
<div class="paragraph"><p>Note: Implementations are not required to combine invocations into groups
of any specific size.
When <strong>SubgroupSize</strong> is 1, <strong>OpSubgroupAnyKHR</strong> and <strong>OpSubgroupAllKHR</strong> will
return <em>Predicate</em> and <strong>OpSubgroupAllEqualKHR</strong> will return <strong>true</strong>.</p></div>
<div class="paragraph"><p>For fragment shaders, invocations in a subgroup may include
invocations corresponding to pixels that are covered by a primitive being
rasterized, as well as invocations corresponding to neighboring pixels not
covered by the primitive.
The invocations for these neighboring pixels (<strong>HelperInvocation</strong>) may be
created so that differencing can be used to evaluate derivative instructions
like <strong>OpDPdx</strong> and <strong>OpDPdy</strong> (section 3.32.16) and implicit derivatives used
by <strong>OpImageSampleImplicitLod</strong> and related functions (section 3.32.10).
The value of <em>Predicate</em> for such <strong>HelperInvocations</strong> contribute to the
value returned by <strong>OpSubgroupAllKHR</strong>, <strong>OpSubgroupAnyKHR</strong>, and
<strong>OpSubgroupAllEqualKHR</strong>.</p></div>
</div></div>
</dd>
<dt class="hdlist1">
(Modify Section 3.31, Capability, adding a row to the Capability table) 
</dt>
<dd>
<div class="openblock">
<div class="content">
<table class="tableblock frame-all grid-all"
style="
width:80%;
">
<col style="width:5%;">
<col style="width:52%;">
<col style="width:42%;">
<thead>
<tr>
<th class="tableblock halign-center valign-middle" colspan="2" > Capability </th>
<th class="tableblock halign-center valign-top" > Depends On</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle" ><p class="tableblock">4431</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><strong>SubgroupVoteKHR</strong></p></td>
<td class="tableblock halign-center valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
</div></div>
</dd>
<dt class="hdlist1">
(Modify Section 3.32.21, Group Instructions, adding to the end of the list of instructions) 
</dt>
<dd>
<div class="openblock">
<div class="content">
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:9%;">
<col style="width:9%;">
<col style="width:27%;">
<col style="width:27%;">
<col style="width:27%;">
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="4" ><p class="tableblock"><a id="OpSubgroupAllKHR"></a><strong>OpSubgroupAllKHR</strong><br>
<br>
Evaluates a predicate for all invocations in the current <strong>Subgroup</strong> that
execute the same dynamic instance of this instruction, resulting in <strong>true</strong>
if <em>Predicate</em> evaluates to <strong>true</strong> for <strong>all</strong> such invocations, otherwise the
result is <strong>false</strong>.
See <a href="#SubgroupVote">Subgroup Vote</a>.<br>
<br>
<em>Result Type</em> must be a <em>Boolean type</em>.<br>
<br>
<em>Predicate</em> must be a <em>Boolean type</em>.</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Capability:<br>
<strong>SubgroupVoteKHR</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4428</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>&lt;id&gt;</em><br>
<em>Result Type</em></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>Result &lt;id&gt;</em></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>&lt;id&gt;</em> <em>Predicate</em></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:9%;">
<col style="width:9%;">
<col style="width:27%;">
<col style="width:27%;">
<col style="width:27%;">
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="4" ><p class="tableblock"><a id="OpSubgroupAnyKHR"></a><strong>OpSubgroupAnyKHR</strong><br>
<br>
Evaluates a predicate for all invocations in the current <strong>Subgroup</strong> that
execute the same dynamic instance of this instruction, resulting in <strong>true</strong>
if <em>Predicate</em> evaluates to <strong>true</strong> for <strong>any</strong> such invocations, otherwise
the result is <strong>false</strong>.
See <a href="#SubgroupVote">Subgroup Vote</a>.<br>
<br>
<em>Result Type</em> must be a <em>Boolean type</em>.<br>
<br>
<em>Predicate</em> must be a <em>Boolean type</em>.</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Capability:<br>
<strong>SubgroupVoteKHR</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4429</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>&lt;id&gt;</em><br>
<em>Result Type</em></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>Result &lt;id&gt;</em></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>&lt;id&gt;</em> <em>Predicate</em></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:9%;">
<col style="width:9%;">
<col style="width:27%;">
<col style="width:27%;">
<col style="width:27%;">
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="4" ><p class="tableblock"><a id="OpSubgroupAllEqualKHR"></a><strong>OpSubgroupAllEqualKHR</strong><br>
<br>
Evaluates a predicate for all invocations in the current <strong>Subgroup</strong> that
execute the same dynamic instance of this instruction, resulting
in <strong>true</strong> if <em>Predicate</em> evaluates <strong>the same</strong> for such invocations,
otherwise the result is <strong>false</strong>.
See <a href="#SubgroupVote">Subgroup Vote</a>.<br>
<br>
<em>Result Type</em> must be a <em>Boolean type</em>.<br>
<br>
<em>Predicate</em> must be a <em>Boolean type</em>.</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Capability:<br>
<strong>SubgroupVoteKHR</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4430</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>&lt;id&gt;</em><br>
<em>Result Type</em></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>Result &lt;id&gt;</em></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><em>&lt;id&gt;</em> <em>Predicate</em></p></td>
</tr>
</tbody>
</table>
</div></div>
</dd>
</dl></div>
</div>
</div>
<div class="sect1">
<h2 id="_validation_rules">Validation Rules</h2>
<div class="sectionbody">
<div class="paragraph"><p>An OpExtension must be added to the SPIR-V for validation layers to check
legal use of this extension:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>OpExtension "SPV_KHR_subgroup_vote"</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_issues">Issues</h2>
<div class="sectionbody">
<div class="olist arabic"><ol class="arabic">
<li>
<p>
SPIR-V 1.1 already has OpGroupAny and OpGroupAll, are these sufficient?
</p>
<div class="openblock">
<div class="content">
<div class="paragraph"><p><strong>RESOLVED</strong>:
<strong>OpGroupAllEqual</strong>(predicate) could be emulated in a compiler front-end
as (<strong>OpGroupAll</strong>(predicate) || !<strong>OpGroupAny</strong>(predicate)). However if
the underlying hardware&#8217;s instruction set actually has a native AllEqual
instruction this would result in either a) reduced performance since
it must execute two instructions instead of one, or b) complicated
compiler heuristics to detect the above pattern and collapse it back
to one instruction. In order to give the full expressiveness of the
higher level languages (such as GLSL), we&#8217;ll add a dedicated
instruction for this.</p></div>
</div></div>
</li>
<li>
<p>
Do we need a capability?
</p>
<div class="openblock">
<div class="content">
<div class="paragraph"><p><strong>RESOLVED</strong>:
Yes. We&#8217;ll add capability with extensions so that it&#8217;s simpler to move
them into the core without needing complicated consumer logic.</p></div>
</div></div>
</li>
<li>
<p>
Where can these instructions be executed?
</p>
<div class="openblock">
<div class="content">
<div class="paragraph"><p><strong>DISCUSSION</strong>:
GL_ARB_shader_group_vote says:
<em>"These functions may be called in conditionally executed code.  In groups
where some invocations do not execute the function call, the value
returned by the function is not affected by any invocation not calling the
function, even when &lt;value&gt; is well-defined for that invocation."</em></p></div>
<div class="paragraph"><p>The existing SPIR-V OpGroup* instructions say:
<em>"All invocations of this module within Execution must reach this point
of execution. This instruction is only guaranteed to work correctly if
placed strictly within uniform control flow within Execution. This ensures
that if any invocation executes it, all invocations will execute it. If
placed elsewhere, an invocation may stall indefinitely."</em></p></div>
<div class="paragraph"><p><strong>RESOLVED</strong>:
Due to the potentially differing semantics between the existing OpGroup*
instructions and the instructions this extension wishes to support,
we&#8217;ll add new dedicated instructions here.</p></div>
</div></div>
</li>
<li>
<p>
Should the SubgroupVoteKHR capability be dependent on the <strong>Shader</strong>
capability?
</p>
<div class="openblock">
<div class="content">
<div class="paragraph"><p><strong>RESOLVED</strong>: No.
There is no technical reason why it needs to be, and this enables
it to be used in Kernels, if so desired and supported.</p></div>
</div></div>
</li>
<li>
<p>
How do OpGroup{All,Any} differ from OpSubgroup{All,Any}KHR?
</p>
<div class="openblock">
<div class="content">
<div class="paragraph"><p><strong>RESOLVED</strong>:
The existing OpGroup instructions can only be used in uniform control
flow, and take an execution scope which can either be workgroup or subgroup.
The OpSubgroup*KHR instructions allow execution in dynamically non-uniform
control flow, and only operate at the subgroup scope.</p></div>
</div></div>
</li>
</ol></div>
</div>
</div>
<div class="sect1">
<h2 id="_revision_history">Revision History</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-rows"
style="
width:100%;
">
<col style="width:4%;">
<col style="width:14%;">
<col style="width:14%;">
<col style="width:66%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Rev</th>
<th class="tableblock halign-left valign-top" >Date</th>
<th class="tableblock halign-left valign-top" >Author</th>
<th class="tableblock halign-left valign-top" >Changes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2016-07-19</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Daniel Koch</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"><strong>Initial draft</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2016-08-09</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Daniel Koch</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Add issue 2 and 3. Require Subgroup scope.
    Editorial changes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2016-08-16</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Daniel Koch</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Add SubgroupVote capability.
    Add language allowing these to be used in conditionally executed code.
    Add more expository language about the functionality.
    Add Validation rules.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2016-09-13</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Daniel Koch</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Add suffix to capability and beautify.
    Move functional language to new section 2.21.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2016-09-23</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Daniel Koch</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Rename to KHR and assign enums.
    Use dedicated instructions instead of trying to leverage existing
    OpGroup instructions.
    Align language with SPV_KHR_shader_ballot. Various clarifications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2016-10-05</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Daniel Koch</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">Incorporated review feedback from dneto.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="footnotes"><hr></div>
<div id="footer">
<div id="footer-text">
Last updated 2018-09-06 10:38:48 MDT
</div>
</div>
</body>
</html>

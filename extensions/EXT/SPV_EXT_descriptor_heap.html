<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>SPV_EXT_descriptor_heap</title>
<style>
@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";
@import "https://cdn.jsdelivr.net/gh/asciidoctor/asciidoctor@2.0/data/stylesheets/asciidoctor-default.css";

p {
    font-family: Arial, Helvetica, sans-serif;
    line-height: normal;
}
em, b, strong {
    color: darkblue;
}

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>SPV_EXT_descriptor_heap</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_name_strings">Name Strings</a></li>
<li><a href="#_contact">Contact</a></li>
<li><a href="#_contributors">Contributors</a></li>
<li><a href="#_status">Status</a></li>
<li><a href="#_version">Version</a></li>
<li><a href="#_dependencies">Dependencies</a></li>
<li><a href="#_overview">Overview</a></li>
<li><a href="#_extension_name">Extension Name</a></li>
<li><a href="#_new_capabilities">New Capabilities</a></li>
<li><a href="#_modifications_to_the_spir_v_specification_version_1_6_revision_5">Modifications to the SPIR-V Specification, Version 1.6, Revision 5</a></li>
<li><a href="#_examples">Examples</a></li>
<li><a href="#_issues">Issues</a></li>
<li><a href="#_revision_history">Revision History</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name_strings">Name Strings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SPV_EXT_descriptor_heap</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contact">Contact</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To report problems with this extension, please open a new issue at:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/KhronosGroup/SPIRV-Headers" class="bare">https://github.com/KhronosGroup/SPIRV-Headers</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributors">Contributors</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Tobias Hector, AMD</p>
</li>
<li>
<p>Alan Baker, Google</p>
</li>
<li>
<p>Ben Ashbaugh, Intel</p>
</li>
<li>
<p>Spencer Fricke, LunarG</p>
</li>
<li>
<p>Faith Ekstrand, Collabora</p>
</li>
<li>
<p>Rodrigo Locatti, Nvidia</p>
</li>
<li>
<p>Guang Xu, AMD</p>
</li>
<li>
<p>Wooyoung Kim, Qualcomm</p>
</li>
<li>
<p>Victor Lomuller, Codeplay</p>
</li>
<li>
<p>Ruihao Zhang, Qualcomm</p>
</li>
<li>
<p>Joerg Wollenschlaegr, Nvidia</p>
</li>
<li>
<p>Erik Hogeman, Arm</p>
</li>
<li>
<p>Marty Johnson, Khronos</p>
</li>
<li>
<p>Shaochi Zhou, AMD</p>
</li>
<li>
<p>KÃ©vin Petit, Arm</p>
</li>
<li>
<p>Jeff Bolz, Nvidia</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_status">Status</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Approved by the SPIR-V Working Group: 2025-08-06</p>
</li>
<li>
<p>Approved by the SPIR-V Working Group: 2025-10-08</p>
</li>
<li>
<p>Approved by the Khronos Board of Promoters: 2025-11-21</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_version">Version</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stripes-even" style="width: 40%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last Modified Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2025-09-08</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Revision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_dependencies">Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension is written against the SPIR-V Specification, Version 1.6 Revision 5.</p>
</div>
<div class="paragraph">
<p>This extension requires SPIR-V 1.0.</p>
</div>
<div class="paragraph">
<p>This extension requires SPV_KHR_untyped_pointers.</p>
</div>
<div class="paragraph">
<p>This extension interacts with SPV_KHR_ray_tracing, SPV_KHR_ray_query, SPV_EXT_shader_64bit_indexing, and SPV_ARM_tensors.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds new built-in variables, decorations, and instructions that can be used to access descriptors bound as descriptor heaps in a client API.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extension_name">Extension Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use this extension within a SPIR-V module, the following
<strong>OpExtension</strong> must be present in the module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>OpExtension "SPV_EXT_descriptor_heap"</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_new_capabilities">New Capabilities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension introduces new capabilities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>DescriptorHeapEXT</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modifications_to_the_spir_v_specification_version_1_6_revision_5">Modifications to the SPIR-V Specification, Version 1.6, Revision 5</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Modify Section 2.2.1, "Instructions":</p>
</div>
<div class="paragraph">
<p>Add <strong>OpBufferPointerEXT</strong> to the list of instructions that define a memory
object declaration.</p>
</div>
<div class="paragraph">
<p>Modify Section 2.2.2, "Types":</p>
</div>
<div class="paragraph">
<p>Add the following definition:</p>
</div>
<div id="Descriptor" class="paragraph">
<p><strong>Descriptor</strong>: An opaque object describing complex state in memory, with a
defined size, and specialized access instructions.
Has a type of <strong>OpTypeBufferEXT</strong>, <strong>OpTypeImage</strong>,
<strong>OpTypeAccelerationStructureKHR</strong>, <strong>OpTypeTensorARM</strong>, or <strong>OpTypeSampler</strong>.</p>
</div>
<div id="Buffer" class="paragraph">
<p><strong>Buffer</strong>: An opaque descriptor to a larger set of memory.
Buffer objects themselves are opaque and cannot be accessed or modified; a
buffer&#8217;s data is accessed by retrieving a pointer to their data with
<strong>OpBufferPointerEXT</strong>.</p>
</div>
<div class="paragraph">
<p>Add <strong>OpTypeBufferEXT</strong> to the list defining <strong>Opaque Type</strong>.</p>
</div>
<div class="paragraph">
<p>In the definition of <em>Explicit Layout</em>, add <strong>OffsetIdEXT</strong> and
<strong>ArrayStrideIdEXT</strong> as alternatives to <strong>Offset</strong> and <strong>ArrayStride</strong>, so that it
reads:</p>
</div>
<div class="paragraph">
<p><em>Explicit Layout</em>: Types with an explicit layout have decorations defining the relative locations of all of their constituents.
A type has an explicit layout if the following statements are true, recursively applied to any nested types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each structure-type member must have an <strong>Offset</strong> or <strong>OffsetIdEXT</strong> decoration.</p>
</li>
<li>
<p>Each array type must have an <strong>ArrayStride</strong> or <strong>ArrayStrideIdEXT</strong> decoration, unless it is an array that contains a structure decorated with <strong>Block</strong> or <strong>BufferBlock</strong>, in which case it must not have an <strong>ArrayStride</strong> or <strong>ArrayStrideIdEXT</strong> decoration.</p>
</li>
<li>
<p>Each structure-type member that is a matrix or array-of-matrices must be decorated with a <strong>MatrixStride</strong> decoration, and one of the <strong>RowMajor</strong> or <strong>ColMajor</strong> decorations.</p>
</li>
<li>
<p><strong>ArrayStride</strong>, <strong>ArrayStrideIdEXT</strong>, <strong>MatrixStride</strong>, <strong>Offset</strong>, and <strong>OffsetIdEXT</strong> decorations must not cause overlap between elements or with other members.</p>
</li>
<li>
<p>Each <strong>ArrayStride</strong>, <strong>ArrayStrideIdEXT</strong>, and <strong>MatrixStride</strong> must be greater than zero.</p>
</li>
<li>
<p>A pointer to a structure decorated with <strong>Block</strong> or <strong>BufferBlock</strong> must not have an <strong>ArrayStride</strong> or <strong>ArrayStrideIdEXT</strong> decoration.</p>
</li>
<li>
<p>All members of a given structure must have distinct <strong>Offset</strong> or <strong>OffsetIdEXT</strong> decorations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Modify Section 2.18.1., "Memory Layout":</p>
</div>
<div class="paragraph">
<p>Add <strong>OffsetIdEXT</strong> and <strong>ArrayStrideIdEXT</strong> to the list of decorations that partially define how a memory buffer is laid out.
Add "or <strong>OffsetIdEXT</strong>" immediately after "<strong>Offset</strong>" in each bullet point immediately after "<strong>Offset</strong>".</p>
</div>
<div class="paragraph">
<p>Modify Section 3.20, "Decoration":</p>
</div>
<div class="paragraph">
<p>Add <strong>OpMemberDecorateIdEXT</strong> to the list of supported instructions.</p>
</div>
<div class="paragraph">
<p>Add these rows to the <strong>Decoration</strong> table:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 3.6363%;">
<col style="width: 40%;">
<col style="width: 5.4545%;">
<col style="width: 5.4545%;">
<col style="width: 5.4545%;">
<col style="width: 40.0002%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle" colspan="2">Decoration</th>
<th class="tableblock halign-left valign-middle" colspan="3">Extra Operands</th>
<th class="tableblock halign-left valign-top">Enabling Capabilities</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">5124</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ArrayStrideIdEXT</strong><br>
Identical to <strong>ArrayStride</strong>, except that the extra operand is a constant &lt;id&gt;.
Must only be applied to arrays containing <a href="#Descriptor">descriptor</a> types.</p></td>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>&lt;id&gt; Array Stride</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DescriptorHeapEXT</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">5125</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OffsetIdEXT</strong><br>
Identical to <strong>Offset</strong>, except that the extra operand is a constant &lt;id&gt;.
Must only be applied to members of structs where the struct contains at least one <a href="#Descriptor">descriptor</a> type.</p></td>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>&lt;id&gt; Byte Offset</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DescriptorHeapEXT</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add the following allowed declaration types <strong>NonReadable</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The result of <strong>OpBufferPointerEXT</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add the following allowed declaration types <strong>NonWritable</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The result of <strong>OpBufferPointerEXT</strong> with the <strong>StorageBuffer</strong> storage class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Modify Section 3.21, "BuiltIn", adding these rows to the BuiltIn table:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 3.6363%;">
<col style="width: 40%;">
<col style="width: 5.4545%;">
<col style="width: 5.4545%;">
<col style="width: 5.4545%;">
<col style="width: 40.0002%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle" colspan="2">BuiltIn</th>
<th class="tableblock halign-left valign-middle" colspan="3">Extra Operands</th>
<th class="tableblock halign-left valign-top">Enabling Capabilities</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">5122</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SamplerHeapEXT</strong><br>
Base pointer to the sampler heap.
Must not be used to decorate a struct member.</p></td>
<td class="tableblock halign-left valign-top" colspan="3"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DescriptorHeapEXT</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">5123</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ResourceHeapEXT</strong><br>
Base pointer to the resource heap.
Must not be used to decorate a struct member.</p></td>
<td class="tableblock halign-left valign-top" colspan="3"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DescriptorHeapEXT</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Modify Section 3.31, "Capability", adding this row to the Capability table:</p>
</div>
<table id="Capability" class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 5.8823%;">
<col style="width: 58.8235%;">
<col style="width: 35.2942%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">Capability</th>
<th class="tableblock halign-center valign-top">Implicitly Declares</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DescriptorHeapEXT</strong><br>
Module uses the <em>SamplerHeapEXT</em> and <em>ResourceHeapEXT</em> built-ins, the <em>OffsetIdEXT</em> and <em>ArrayStrideIdEXT</em> decorations, and <strong>OpMemberDecorateIdEXT</strong>, <strong>OpTypeBufferEXT</strong>, <strong>OpConstantSizeOfEXT</strong>, <strong>OpUntypedImageTexelPointerEXT</strong> and <strong>OpBufferPointerEXT</strong> instructions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>UntypedPointersKHR</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Modify Section 3.56.3, "Annotation Instructions":</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="5"><p class="tableblock"><a id="OpMemberDecorateIdEXT"></a><strong>OpMemberDecorateIdEXT</strong></p>
<p class="tableblock">Add a <strong>Decoration</strong> to a member of a structure type, using <em>&lt;id&gt;s</em> as <strong>Extra Operands</strong>.</p>
<p class="tableblock"><em>Structure Type</em> is the <em>&lt;id&gt;</em> of a type from <strong>OpTypeStruct</strong>.</p>
<p class="tableblock"><em>Member</em> is the number of the member to decorate in the type. The first member is member 0, the next is member 1, &#8230;&#8203;</p>
<p class="tableblock">This instruction is only valid if the <strong>Decoration</strong> operand is a decoration
that takes <strong>Extra Operands</strong> that are &lt;id&gt; operands.
All such <em>&lt;id&gt;</em> <strong>Extra Operands</strong> must be constant instructions or
<strong>OpVariable</strong> instructions.
All <em>&lt;id&gt;</em> <strong>Extra Operands</strong> must appear before <em>Structure Type</em>.</p>
<p class="tableblock">NOTE: Currently, only <strong>OffsetIdEXT</strong> and <strong>ArrayStrideIdEXT</strong> are valid with this instruction.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capability:<br>
<strong>DescriptorHeapEXT</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 + variable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5127</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt; Structure Type</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Literal Member</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Decoration</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;, &lt;id&gt;, &#8230;&#8203;<br>
_See *Decoration*</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Modify Section 3.56.6, "Type-Declaration Instructions":</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><a id="OpTypeBufferEXT"></a><strong>OpTypeBufferEXT</strong></p>
<p class="tableblock">Declare a new <em>buffer</em> type.</p>
<p class="tableblock"><em>Storage Class</em> is the storage class of the underlying data in the buffer.
<em>Storage Class</em> must be <em>Uniform</em> or <em>StorageBuffer</em>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Capability">Capability</a>:<br>
<strong>DescriptorHeapEXT</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5115</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ResultId"><em>Result &lt;id&gt;</em> </a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Storage Class</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Modify Section 3.56.7, "Constant Instructions":</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="4"><p class="tableblock"><a id="OpConstantSizeOfEXT"></a><strong>OpConstantSizeOfEXT</strong></p>
<p class="tableblock">Get the compile time size of a resource type.</p>
<p class="tableblock"><em>Type</em> is the type to query the size of.</p>
<p class="tableblock"><em>Result Type</em> must be a 32-bit or 64-bit <em>integer type</em> scalar.</p>
<p class="tableblock"><em>Type</em> must be a <a href="#Descriptor">descriptor</a> type instruction.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capability:<br>
<strong>DescriptorHeapEXT</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5129</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;<br>
Result Type</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Result &lt;id&gt;</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em><br>
<em>Type</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Modify Section 3.56.8, "Memory Instructions":</p>
</div>
<div class="paragraph">
<p>Add the following instructions:</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="4"><p class="tableblock"><a id="OpBufferPointerEXT"></a><strong>OpBufferPointerEXT</strong></p>
<p class="tableblock">Returns a pointer to the data of a buffer from the <em>ResourceHeapEXT</em> built-in.</p>
<p class="tableblock"><em>Result Type</em> must be a pointer type with a <em>Storage Class</em> of <em>Uniform</em> or <em>StorageBuffer</em>.</p>
<p class="tableblock"><em>Buffer</em> is the buffer to obtain a pointer from.</p>
<p class="tableblock"><em>Buffer</em> must be an untyped pointer into a variable declared with the <em>ResourceHeapEXT</em> built-in.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Capability">Capability</a>:<br>
<strong>DescriptorHeapEXT</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5119</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Result Type</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Result &lt;id&gt;</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Buffer</em></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 4.7619%;">
<col style="width: 9.5238%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="7"><p class="tableblock"><a id="OpUntypedImageTexelPointerEXT"></a><strong>OpUntypedImageTexelPointerEXT</strong><br>
<br>
Form a pointer to a texel of an image. Use of such a pointer is limited to atomic operations.<br>
<br>
<em>Result Type</em> must be <strong>OpTypeUntypedPointerKHR</strong> whose <em>Storage Class</em> operand is <strong>Image</strong>.<br>
<br>
<em>Image Type</em> must be an <strong>OpTypeImage</strong>.
The <em>Dim</em> operand of <em>Image Type</em> must not be <strong>SubpassData</strong>.<br>
<br>
<em>Image</em> must have a type of <strong>OpTypeUntypedPointerKHR</strong><br>
<br>
<em>Coordinate</em> and <em>Sample</em> specify which texel and sample within the image to form a pointer to.<br>
<br>
<em>Coordinate</em> must be a scalar or vector of <em>integer type</em>.
It must have the number of components specified below, given the following <em>Arrayed</em> and <em>Dim</em> operands of <em>Image Type</em>.<br>
<br>
If <em>Arrayed</em> is 0:<br>
<strong>1D</strong>: scalar<br>
<strong>2D</strong>: 2 components<br>
<strong>3D</strong>: 3 components<br>
<strong>Cube</strong>: 3 components<br>
<strong>Rect</strong>: 2 components<br>
<strong>Buffer</strong>: scalar<br>
<br>
If <em>Arrayed</em> is 1:<br>
<strong>1D</strong>: 2 components<br>
<strong>2D</strong>: 3 components<br>
<strong>Cube</strong>: 3 components; the face and layer combine into the 3rd component, <em>layer_face</em>, such that face is <em>layer_face</em> % 6 and layer is floor(<em>layer_face</em> / 6)<br>
<br>
<em>Sample</em> must be an <em>integer type</em> scalar. It specifies which sample to select at the given coordinate. Behavior is undefined unless it is a valid <em>&lt;id&gt;</em> for the value 0 when the <strong>OpTypeImage</strong> has <em>MS</em> of 0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Capability">Capability</a>:<br>
<strong>DescriptorHeapEXT</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5126</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Result Type</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Result &lt;id&gt;</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Image Type</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Image</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Coordinate</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;id&gt;</em> <em>Sample</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Modify Section 2.16.1, "Universal Validation Rules":</p>
</div>
<div class="paragraph">
<p>Under:
    * It is invalid for a pointer to be an operand to any instruction other than:</p>
</div>
<div class="paragraph">
<p>Add:
    <strong> <strong>OpBufferPointerEXT</strong>
    </strong> <strong>OpUntypedImageTexelPointerEXT</strong></p>
</div>
<div class="paragraph">
<p>Under:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is invalid for a pointer to be the <em>Result</em> of any instruction other than:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OpBufferPointerEXT</strong></p>
</li>
<li>
<p><strong>OpUntypedImageTexelPointerEXT</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples">Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_heap_declarations">Heap declarations</h3>
<div class="paragraph">
<p>Any shader using heaps will likely use the same declarations for each heap, roughly as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-spirv" data-lang="spirv">                                  OpDecorate %sampler_heap BuiltIn SamplerHeapEXT
                                  OpDecorate %resource_heap BuiltIn ResourceHeapEXT

      %uniformconstant_ptr_type = OpTypeUntypedPointerKHR UniformConstant
                %input_ptr_type = OpTypeUntypedPointerKHR Input
                  %sampler_heap = OpUntypedVariableKHR %uniformconstant_ptr_type UniformConstant
                 %resource_heap = OpUntypedVariableKHR %uniformconstant_ptr_type UniformConstant</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that each heap is untyped; the resource types and placeholder types are only used when the heap is dereferenced, as noted in SPV_KHR_untyped_pointers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_buffer_access">Buffer access</h3>
<div class="paragraph">
<p>This example gets a pointer to buffer data, which requires a little more work than an image or sampler, as there is no buffer type in core SPIR-V.
This extension adds a buffer type that has a size defined by the client API.
<code>OpBufferPointerEXT</code> is used to extract a pointer to the underlying data of the buffer from the dereferenced heap pointer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-spirv" data-lang="spirv">                                  OpDecorateId %storage_buffer_array_type ArrayStrideIdEXT %buffer_size

                     %size_type = OpTypeInt 32 0
           %storage_buffer_type = OpTypeBufferEXT StorageBuffer
     %storage_buffer_array_type = OpTypeRuntimeArray %storage_buffer_type
                   %buffer_size = OpConstantSizeOfEXT %size_type %storage_buffer_type
      %uniformconstant_ptr_type = OpTypeUntypedPointerKHR UniformConstant
        %storagebuffer_ptr_type = OpTypeUntypedPointerKHR StorageBuffer

                    %buffer_ptr = OpUntypedAccessChainKHR %uniformconstant_ptr_type %storage_buffer_array_type %resource_heap %heap_index
               %buffer_data_ptr = OpBufferPointerEXT %storagebuffer_ptr_type %buffer_ptr</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_issues">Issues</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Is there a way to tag different images from the heap as aliases?</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Not directly, but workarounds are possible.</p>
</div>
<div class="paragraph">
<p>For Vulkan, alias decorations in SPIR-V only serve to state that you are accessing the same <em>descriptor</em>, which is a fairly unlikely situation in the first place, and is just as doable today with descriptor arrays. The only way to run into this in a valid manner would be to have two matching indices OR have a known identical descriptor in the source at two locations (possible with either Vulkan&#8217;s VK_EXT_descriptor_buffer or VK_EXT_descriptor_heap extensions), or have two independent index values that match. So it&#8217;s a vanishingly unlikely case, and a pre-existing condition.</p>
</div>
<div class="paragraph">
<p>If aliasing is necessary to express, there is nothing to tag the decoration onto when obtaining an element of an array, as you cannot use <code>Aliased</code> or <code>AliasedPointer</code> on an access chain instruction. This can be worked around though, by passing the resulting handles to a function and decorating the function parameters with <code>Aliased</code>/<code>AliasedPointer</code>, and accessing them through that function. This works with both descriptor bindings and heaps.</p>
</div>
<div class="paragraph">
<p>Also note that at the time of writing, there is no way to tag this kind of aliasing in HLSL, and as HLSL compilers are intended as the initial primary consumer of this extension, improving this situation is not a goal for this extension.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_revision_history">Revision History</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-rows stripes-even stretch">
<colgroup>
<col style="width: 4.7619%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Rev</th>
<th class="tableblock halign-left valign-top">Date</th>
<th class="tableblock halign-left valign-top">Author</th>
<th class="tableblock halign-left valign-top">Changes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2025-09-08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tobias Hector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal revisions</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>